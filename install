#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

PREVIOUS_PWD="$(pwd)"
if ! command -v "yay" &> /dev/null; then
  echo "Installing yay..."
  cd "$(mktemp -d)"
  git clone https://aur.archlinux.org/yay.git
  cd yay
  makepkg -si --noconfirm
  cd "$PREVIOUS_PWD"
fi

echo "Synchronising packages..."
./sync

stow --verbose --dir "$HOME/.dotfiles/configs" --target ~ $(ls "$HOME/.dotfiles/configs")

./installers/groups.sh
./installers/services.sh

./installers/fish.sh
./installers/nordvpn.sh
./installers/kakoune.sh
./installers/postgres.sh
./installers/fonts.sh

echo "Done!"
